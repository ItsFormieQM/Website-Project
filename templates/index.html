<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>The Beginning.</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    /* ===== UNDERTALE CORE ===== */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: "Determination Sans";
      image-rendering: pixelated;
    }

    body {
      background: black;
      color: white;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* ===== DIALOG BOX ===== */
    #platform-selector {
      position: fixed;
      inset: 0;
      background: black;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .dialogue {
      width: 90%;
      max-width: 600px;
      border: 4px solid white;
      padding: 24px;
      font-size: 18px;
    }

    .dialogue p {
      margin-bottom: 20px;
    }

    .choices {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .choice {
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px; /* space between pointer and text */
      padding: 4px 0;
    }

    /* Pointer image hidden by default */
    .choice .pointer {
      width: 16px;
      height: 16px;
      image-rendering: pixelated;
      visibility: hidden;
    }

    /* Show pointer on hover */
    .choice:hover .pointer {
      visibility: visible;
    }

    /* ===== MAIN CONTENT ===== */
    #content {
      display: none;
      text-align: center;
    }

    #twitch-text span {
      display: inline-block;
      transition: transform 0.05s; /* smooth twitch */
    }

    body.pc #content,
    body.mobile #content {
      display: block;
    }

    body.pc #platform-selector,
    body.mobile #platform-selector {
      display: none;
    }
  </style>
</head>

<body>

  <!-- UNDERTALE DIALOG -->
<!-- INTRO SCREEN -->
<!-- INTRO SCREEN -->
<!-- LOADING SCREEN -->
<div id="loading-screen" class="dialogue">
  <p>* Loadingâ€¦ please wait.</p>
</div>

<!-- INTRO SCREEN (hidden initially) -->
<div id="intro-screen" class="dialogue" style="display:none;">
  <p id="twitch-text">Are you sure that you want to continue?</p>
  <button id="continue-btn">CONTINUE</button>
</div>

<!-- PLATFORM SELECTOR (hidden initially) -->
<div id="platform-selector" class="dialogue" style="display:none;">
  <p id="twitch-text">* Before you continue.</p>
  <p id="twitch-text">* Please choose the platform you are using:</p>

  <div class="choices">
  <div class="choice" onclick="window.location.href='{{ url_for('pc') }}'">
    <img class="pointer" src="{{ url_for('static', filename='sprites/redsoul.png') }}" alt="pointer">
    PC
  </div>

  <div class="choice" onclick="window.location.href='{{ url_for('mobile') }}'">
    <img class="pointer" src="{{ url_for('static', filename='sprites/redsoul.png') }}" alt="pointer">
    MOBILE
  </div>
</div>




  <!-- MAIN CONTENT -->
  <div id="content">
    <h1>* Welcome.</h1>
    <p>* Your journey begins.</p>
    <br>
    <button onclick="resetPlatform()">RESET</button>
  </div>

 <script>
const continueBtn = document.getElementById("continue-btn");
const introScreen = document.getElementById("intro-screen");
const platformSelector = document.getElementById("platform-selector");

const textElement = document.getElementById('twitch-text');
const text = textElement.textContent;
textElement.textContent = ''; // clear original text

// wrap each character in a span
for (let char of text) {
    const span = document.createElement('span');
    span.textContent = char;
    textElement.appendChild(span);
}

const letters = textElement.querySelectorAll('span');

function twitchLetters() {
    letters.forEach(span => {
        const maxOffset = 1.2; // pixels of twitch
        const x = Math.floor(Math.random() * (maxOffset * 2 + 1)) - maxOffset;
        const y = Math.floor(Math.random() * (maxOffset * 2 + 1)) - maxOffset;
        span.style.transform = `translate(${x}px, ${y}px)`;
    });
}

// update every 50ms for fast twitch
setInterval(twitchLetters, 50);

continueBtn.addEventListener("click", () => {
  // Hide intro screen
  introScreen.style.display = "none";

  // Show platform selector
  platformSelector.style.display = "block";

  // Optional: play menu music now
  playMenuMUS();
});
window.addEventListener("load", () => {
  // Everything (images, audio, CSS) is fully loaded now
  const loadingScreen = document.getElementById("loading-screen");
  const introScreen = document.getElementById("intro-screen");

  // Hide the loading screen
  loadingScreen.style.display = "none";

  // Show the intro screen
  introScreen.style.display = "block";
});


let area = 1;

function playMenuMoveSFX() {
    let menuMvSFX = new Audio("/static/sfx/snd_menumove.wav");
    menuMvSFX.volume = 0.7;
    menuMvSFX.loop = false;
    menuMvSFX.play();
}

function playMenuMUS() {
    let menuMUS = new Audio("/static/music/menu.ogg");
    menuMUS.volume = 1;
    menuMUS.loop = true;
    menuMUS.play();
}

const choices = document.querySelectorAll(".choice");

choices.forEach(choice => {
  choice.addEventListener("mouseenter", () => {
    const pointer = choice.querySelector(".pointer");
    if (!pointer) return;

    const style = window.getComputedStyle(pointer);

    if (style.visibility === "visible") {
      playMenuMoveSFX(); // Calls your external function
    }
  });
});

    const saved = localStorage.getItem("platform");

    if (saved) {
      document.body.classList.add(saved);
    }

    function setPlatform(platform) {
      localStorage.setItem("platform", platform);
      document.body.classList.add(platform);
    }

    function resetPlatform() {
      localStorage.removeItem("platform");
      location.reload();
    }

function goToPlatform(platform) {
    localStorage.setItem("platform", platform); // optional, save selection

    if(platform === 'pc') {
        // stay on current page or load PC-specific content
        document.body.classList.add('pc');
        document.getElementById('platform-selector').style.display = 'none';
        document.getElementById('content').style.display = 'block';
    } else if(platform === 'mobile') {
        // go to a separate HTML file for mobile
        window.location.href = "mobile.html"; // <-- path to your mobile page
    }
}
  </script>

</body>
</html>
